{% extends "base.html" %}

{% block title %}Polar/Rectangular Coordinates Converter{% endblock %}

{% block meta_description %}Convert coordinates between Rectangular $(x, y)$ and Polar $(r, \theta)$ forms.{% endblock %}

{% block meta_keywords %}polar coordinates, rectangular coordinates, cartesian, r theta, x y, coordinate conversion, math calculator{% endblock %}

{% block extra_head %}
<script src="https://cdn.tailwindcss.com"></script>
<style>
    /* Styling for the central calculation block */
    .solver-wrapper {
        background: #fdf2f8; /* Very light pink background */
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        max-width: 850px;
        margin: 0 auto;
        font-family: 'Inter', sans-serif;
    }
    
    .converter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 30px;
    }

    .converter-section {
        padding: 25px;
        border-radius: 10px;
        background-color: #fce7f3; /* Light pink */
        border: 2px solid #db2777; /* Deep Pink accent */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }
    
    .input-group-half {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-top: 15px;
    }
    
    .input-box label {
        font-size: 0.9rem;
        font-weight: 500;
        color: #831843; /* Darker pink */
        display: block;
        margin-bottom: 3px;
    }

    .input-field {
        width: 100%;
        padding: 10px;
        font-size: 1.1rem;
        border: 2px solid #ec4899; /* Medium pink border */
        border-radius: 6px;
        text-align: center;
        font-weight: 600;
        color: #9d174d;
    }
    
    .result-card {
        margin-top: 20px;
        padding: 15px;
        border-radius: 8px;
        background-color: #fff1f2; /* Lightest red/pink */
        border-left: 5px solid #d946ef; /* Violet accent */
    }

    .result-error {
        border-left: 5px solid #ef4444; /* Red */
        background-color: #fee2e2;
        color: #991b1b;
        padding: 20px;
        border-radius: 8px;
    }
    
    .output-label {
        font-size: 1.1rem;
        font-weight: 700;
        text-align: center;
        color: #1f2937;
    }

    .output-value {
        font-size: 1.6rem;
        font-weight: 800;
        text-align: center;
        color: #9333ea; /* Violet */
        word-break: break-all;
        margin-top: 5px;
    }
    .result-subtext {
        font-size: 0.9rem;
        color: #64748b;
        text-align: center;
        margin-top: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto p-4 md:p-8">
    <h1 class="text-3xl font-extrabold mb-2 text-gray-900 text-center">Coordinate System Converter</h1>
    <p class="text-gray-600 mb-6 text-center">
        Convert points between Rectangular $(\mathbf{x}, \mathbf{y})$ and Polar $(\mathbf{r}, \mathbf{\theta})$ coordinates.
    </p>

    <div class="solver-wrapper">
        
        <div class="converter-grid">

            <!-- --- 1. Rectangular to Polar --- -->
            <div class="converter-section">
                <h3 class="text-xl font-bold text-center text-purple-700 mb-4">Rectangular $\rightarrow$ Polar $(\mathbf{r}, \mathbf{\theta})$</h3>
                <form id="rect-to-polar-form" class="space-y-4">
                    <p class="text-center text-sm text-pink-700 mb-2">Input: $(\mathbf{x}, \mathbf{y})$</p>
                    <div class="input-group-half">
                        <div class="input-box">
                            <label for="x-input">X-Coordinate:</label>
                            <input type="number" id="x-input" value="3" required step="any"
                                   placeholder="x"
                                   class="input-field shadow-inner focus:shadow-xl transition-shadow">
                        </div>
                        <div class="input-box">
                            <label for="y-input">Y-Coordinate:</label>
                            <input type="number" id="y-input" value="4" required step="any"
                                   placeholder="y"
                                   class="input-field shadow-inner focus:shadow-xl transition-shadow">
                        </div>
                    </div>
                    
                    <button type="submit"
                            class="w-full bg-pink-600 text-white font-bold py-2 mt-4 rounded-lg shadow-xl hover:bg-pink-700 transition duration-150 transform hover:scale-[1.01]">
                        Calculate Polar
                    </button>
                </form>

                <div id="polar-output" class="result-card hidden"></div>
            </div>

            <!-- --- 2. Polar to Rectangular --- -->
            <div class="converter-section">
                <h3 class="text-xl font-bold text-center text-purple-700 mb-4">Polar $\rightarrow$ Rectangular $(\mathbf{x}, \mathbf{y})$</h3>
                <form id="polar-to-rect-form" class="space-y-4">
                    <p class="text-center text-sm text-pink-700 mb-2">Input: $(\mathbf{r}, \mathbf{\theta}$ in Degrees)</p>
                    <div class="input-group-half">
                        <div class="input-box">
                            <label for="r-input">Radius ($\mathbf{r}$):</label>
                            <input type="number" id="r-input" value="5" required step="any"
                                   placeholder="r"
                                   class="input-field shadow-inner focus:shadow-xl transition-shadow">
                        </div>
                        <div class="input-box">
                            <label for="theta-deg-input">Angle ($\mathbf{\theta}$ in $\deg$):</label>
                            <input type="number" id="theta-deg-input" value="53.13" required step="any"
                                   placeholder="Angle (deg)"
                                   class="input-field shadow-inner focus:shadow-xl transition-shadow">
                        </div>
                    </div>
                    
                    <button type="submit"
                            class="w-full bg-violet-600 text-white font-bold py-2 mt-4 rounded-lg shadow-xl hover:bg-violet-700 transition duration-150 transform hover:scale-[1.01]">
                        Calculate Rectangular
                    </button>
                </form>

                <div id="rect-output" class="result-card hidden"></div>
            </div>

        </div>
        
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const PI = Math.PI;

    /**
     * Updates the results display with appropriate styling and content.
     */
    function displayResult(containerId, className, contentHtml) {
        const outputDiv = document.getElementById(containerId);
        outputDiv.classList.remove('hidden', 'result-error');
        outputDiv.classList.add(className);
        outputDiv.innerHTML = contentHtml;
    }

    /**
     * Validates inputs for conversion.
     */
    function validateInputs(values) {
        return values.every(val => !isNaN(val));
    }

    // -------------------------------------------------------------------
    // --- 1. Rectangular (x, y) to Polar (r, theta) Logic ---
    // -------------------------------------------------------------------

    document.getElementById('rect-to-polar-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const x = parseFloat(document.getElementById('x-input').value.trim());
        const y = parseFloat(document.getElementById('y-input').value.trim());
        
        document.getElementById('polar-output').classList.add('hidden');

        if (!validateInputs([x, y])) {
            const htmlContent = `<p class="font-bold text-center">Invalid Input</p><p class="text-center">Please enter valid numbers for X and Y coordinates.</p>`;
            displayResult('polar-output', 'result-error', htmlContent);
            return;
        }

        // Calculation
        const r = Math.hypot(x, y); // r = sqrt(x^2 + y^2)
        let thetaRad = Math.atan2(y, x); // theta in radians, handles quadrants
        
        // Convert to degrees
        let thetaDeg = thetaRad * (180 / PI);
        
        // Ensure angle is between 0 and 360 degrees (optional, but cleaner)
        if (thetaDeg < 0) {
            thetaDeg += 360;
        }

        // Rounding for display
        const r_f = r.toFixed(4);
        const thetaDeg_f = thetaDeg.toFixed(4);
        const thetaRad_f = thetaRad.toFixed(4);

        // Result Display
        let htmlContent = `
            <p class="output-label">Polar Coordinates $(\mathbf{r}, \\mathbf{\\theta})$:</p>
            <div class="output-value">
                $$\\mathbf{(${r_f}, ${thetaDeg_f}^{\\circ})}$$
            </div>
            <p class="result-subtext">
                Radius $\\mathbf{r} = ${r_f}$
            </p>
            <p class="result-subtext">
                Angle $\\mathbf{\\theta} \\approx ${thetaDeg_f}^{\\circ}$ (or ${thetaRad_f} \text{ rad})
            </p>
        `;
        
        displayResult('polar-output', 'result-card', htmlContent);
    });

    // -------------------------------------------------------------------
    // --- 2. Polar (r, theta) to Rectangular (x, y) Logic ---
    // -------------------------------------------------------------------

    document.getElementById('polar-to-rect-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const r = parseFloat(document.getElementById('r-input').value.trim());
        const thetaDeg = parseFloat(document.getElementById('theta-deg-input').value.trim());
        
        document.getElementById('rect-output').classList.add('hidden');

        if (!validateInputs([r, thetaDeg])) {
            const htmlContent = `<p class="font-bold text-center">Invalid Input</p><p class="text-center">Please enter valid numbers for Radius (r) and Angle (degrees).</p>`;
            displayResult('rect-output', 'result-error', htmlContent);
            return;
        }

        // Calculation
        const thetaRad = thetaDeg * (PI / 180); // Convert degrees to radians
        
        // x = r * cos(theta)
        const x = r * Math.cos(thetaRad); 
        // y = r * sin(theta)
        const y = r * Math.sin(thetaRad); 
        
        // Rounding for display
        const x_f = x.toFixed(4);
        const y_f = y.toFixed(4);

        // Result Display
        let htmlContent = `
            <p class="output-label">Rectangular Coordinates $(\mathbf{x}, \mathbf{y})$:</p>
            <div class="output-value">
                $$\\mathbf{(${x_f}, ${y_f})}$$
            </div>
            <p class="result-subtext">
                X-Coordinate $\\mathbf{x} = ${x_f}$
            </p>
            <p class="result-subtext">
                Y-Coordinate $\\mathbf{y} = ${y_f}$
            </p>
        `;
        
        displayResult('rect-output', 'result-card', htmlContent);
    });
</script>
{% endblock %}