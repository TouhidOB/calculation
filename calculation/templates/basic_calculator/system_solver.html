{% extends "base.html" %}

{% block title %}System of Equations Solver (2x2){% endblock %}

{% block meta_description %}Solve 2x2 systems of linear equations instantly using Cramer's Rule. Find the unique solution for x and y.{% endblock %}

{% block meta_keywords %}system of equations, linear algebra, 2x2 matrix, cramer's rule, simultaneous equations, solver{% endblock %}

{% block extra_head %}
<script src="https://cdn.tailwindcss.com"></script>
<style>
    /* Styling for the central calculation block */
    .solver-wrapper {
        background: #fdfdff;
        padding: 30px;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        max-width: 650px;
        margin: 0 auto;
        font-family: 'Inter', sans-serif;
    }
    
    .equation-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
    }

    .equation-input-group {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr; /* a, b, c columns */
        align-items: center;
        gap: 10px;
        padding: 15px;
        background-color: #f8f8fb;
        border-radius: 8px;
    }

    .equation-label {
        font-size: 1.2rem;
        font-weight: 600;
        color: #3b82f6;
        margin-bottom: 5px;
        display: block;
        text-align: center;
        grid-column: span 3;
    }

    .input-coeff {
        width: 100%;
        padding: 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        text-align: center;
    }
    
    .input-wrapper {
        display: flex;
        align-items: center;
    }
    
    .input-wrapper span {
        margin-left: 5px;
        font-weight: 500;
        color: #6b7280;
    }

    .result-box {
        margin-top: 25px;
        padding: 20px;
        border-radius: 10px;
        border-left: 5px solid #10b981;
        background-color: #ecfdf5;
        color: #065f46;
    }
    
    .result-error {
        border-left: 5px solid #ef4444;
        background-color: #fee2e2;
        color: #991b1b;
    }

    /* LaTeX-style formatting for equations */
    .latex-eq {
        font-family: 'Times New Roman', serif;
        font-style: italic;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto p-4 md:p-8">
    <h1 class="text-3xl font-extrabold mb-2 text-gray-900 text-center">System of Equations Solver ($2 \times 2$)</h1>
    <p class="text-gray-600 mb-6 text-center">
        Solve the system:
        $$
        \begin{cases}
            a_1 x + b_1 y = c_1 \\
            a_2 x + b_2 y = c_2
        \end{cases}
        $$
        Enter the coefficients below to find $x$ and $y$.
    </p>

    <div class="solver-wrapper">
        <form id="system-form" class="space-y-6">
            
            <div class="equation-container">
                
                <!-- Equation 1 Input -->
                <div class="equation-input-group">
                    <label class="equation-label">Equation 1 ($a_1 x + b_1 y = c_1$)</label>
                    <div class="input-wrapper">
                        <input type="number" id="a1" value="2" step="any" required class="input-coeff">
                        <span>$x$</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="b1" value="3" step="any" required class="input-coeff">
                        <span>$y$</span>
                    </div>
                    <div class="input-wrapper">
                        <span>$=$</span>
                        <input type="number" id="c1" value="8" step="any" required class="input-coeff">
                    </div>
                </div>

                <!-- Equation 2 Input -->
                <div class="equation-input-group">
                    <label class="equation-label">Equation 2 ($a_2 x + b_2 y = c_2$)</label>
                    <div class="input-wrapper">
                        <input type="number" id="a2" value="1" step="any" required class="input-coeff">
                        <span>$x$</span>
                    </div>
                    <div class="input-wrapper">
                        <input type="number" id="b2" value="-1" step="any" required class="input-coeff">
                        <span>$y$</span>
                    </div>
                    <div class="input-wrapper">
                        <span>$=$</span>
                        <input type="number" id="c2" value="-1" step="any" required class="input-coeff">
                    </div>
                </div>
            </div>

            <button type="submit"
                    class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg shadow-md hover:bg-blue-700 transition duration-150 transform hover:scale-[1.01]">
                Calculate Solution
            </button>
        </form>

        <!-- Result Display Area -->
        <div id="result-container" class="mt-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b pb-2">Results</h2>
            <div id="solution-output" class="result-box hidden">
                <!-- Results will be injected here -->
            </div>
        </div>
        
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    /**
     * Calculates the determinant of a 2x2 matrix: |A| = ad - bc
     * @param {number} a - Top left coefficient.
     * @param {number} b - Top right coefficient.
     * @param {number} c - Bottom left coefficient.
     * @param {number} d - Bottom right coefficient.
     * @returns {number} The determinant.
     */
    function determinant2x2(a, b, c, d) {
        return a * d - b * c;
    }

    document.getElementById('system-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const a1 = parseFloat(document.getElementById('a1').value);
        const b1 = parseFloat(document.getElementById('b1').value);
        const c1 = parseFloat(document.getElementById('c1').value);
        const a2 = parseFloat(document.getElementById('a2').value);
        const b2 = parseFloat(document.getElementById('b2').value);
        const c2 = parseFloat(document.getElementById('c2').value);

        const outputDiv = document.getElementById('solution-output');
        outputDiv.classList.add('hidden');
        outputDiv.classList.remove('result-error');
        outputDiv.innerHTML = '';

        // --- 1. Calculate the Main Determinant (D) ---
        // D = | a1 b1 |
        //     | a2 b2 |
        const D = determinant2x2(a1, b1, a2, b2);
        
        let htmlContent = '';
        
        // --- 2. Check for Unique Solution ---
        if (Math.abs(D) < 1e-9) { 
            // Determinant is close to zero (parallel or same lines)
            
            // Calculate Dx and Dy to check consistency
            const Dx = determinant2x2(c1, b1, c2, b2);
            const Dy = determinant2x2(a1, c1, a2, c2);

            if (Math.abs(Dx) < 1e-9 && Math.abs(Dy) < 1e-9) {
                // Dx=0 and Dy=0 means the lines are identical (Infinite Solutions)
                htmlContent += `<p class="text-lg font-bold mb-2">No Unique Solution (Dependent System)</p>`;
                htmlContent += `<p>Determinant $D$ is zero. The two equations represent the **same line**, meaning there are **infinitely many solutions**.</p>`;
                htmlContent += `<p class="mt-2">Solution is all points on the line: $${a1} x + ${b1} y = ${c1}$</p>`;
            } else {
                // Dx != 0 or Dy != 0 means the lines are parallel (No Solution)
                htmlContent += `<p class="text-lg font-bold mb-2">No Solution (Inconsistent System)</p>`;
                htmlContent += `<p>Determinant $D$ is zero. The two equations represent **parallel lines**, meaning there is **no solution**.</p>`;
            }
            
            displayResult('result-error', htmlContent);
            return;
        }

        // --- 3. Calculate Determinants Dx and Dy (Unique Solution exists) ---
        
        // Dx = | c1 b1 |
        //      | c2 b2 |
        const Dx = determinant2x2(c1, b1, c2, b2);

        // Dy = | a1 c1 |
        //      | a2 c2 |
        const Dy = determinant2x2(a1, c1, a2, c2);

        // --- 4. Calculate Roots (Cramer's Rule) ---
        const x = Dx / D;
        const y = Dy / D;

        // Displaying results
        htmlContent += `<p class="text-xl font-bold mb-3 text-green-700">Unique Solution Found</p>`;
        
        htmlContent += `<div class="mb-4">`;
        htmlContent += `<p class="text-base font-semibold">Main Determinant ($D$): ${D.toFixed(4)}</p>`;
        htmlContent += `<p class="text-base font-semibold">Determinant $D_x$: ${Dx.toFixed(4)}</p>`;
        htmlContent += `<p class="text-base font-semibold">Determinant $D_y$: ${Dy.toFixed(4)}</p>`;
        htmlContent += `</div>`;
        
        htmlContent += `<p class="text-2xl font-bold mt-4">`;
        htmlContent += `Solution: $x = \\mathbf{${x.toFixed(6)}}$ and $y = \\mathbf{${y.toFixed(6)}}$`;
        htmlContent += `</p>`;
        
        displayResult('', htmlContent); // No error class
    });

    /**
     * Updates the results display with appropriate styling and content.
     * @param {string} className - Tailwind class name for coloring (e.g., 'result-error').
     * @param {string} contentHtml - HTML string containing the calculated results.
     */
    function displayResult(className, contentHtml) {
        const outputDiv = document.getElementById('solution-output');
        // Reset classes
        outputDiv.className = 'result-box'; 
        if (className) {
            outputDiv.classList.add(className);
        }
        outputDiv.innerHTML = contentHtml;
        outputDiv.classList.remove('hidden');
    }
    
    // Initial State Check (if you want default values to appear immediately)
    // window.onload = () => document.getElementById('system-form').dispatchEvent(new Event('submit'));
</script>
{% endblock %}