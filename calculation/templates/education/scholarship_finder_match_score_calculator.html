{% extends "base.html" %}

{% block title %}Scholarship Match Score Calculator{% endblock %}

{% block meta_description %}Calculate your potential match score for scholarships based on GPA, financial need, major, and extracurricular involvement.{% endblock %}

{% block meta_keywords %}scholarship match, application score, financial aid, GPA calculator, merit scholarship, college funding{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
    .calc-wrapper {
        background: white;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid #dee2e6;
    }

    .score-section {
        border: 1px solid #dee2e6;
        border-radius: 12px;
        padding: 20px;
        height: 100%;
        background-color: #f8f9fa;
        transition: border-color 0.3s ease;
    }

    .score-section:focus-within {
        border-color: #0d6efd;
        background-color: #fff;
    }

    .section-title {
        font-weight: 700;
        font-size: 0.95rem;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
    }

    #score-display-box {
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        min-height: 200px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        border: 2px dashed #dee2e6;
    }

    #match-score {
        font-size: 5rem;
        font-weight: 900;
        line-height: 1;
    }

    /* Professional State Colors */
    .high-match { background-color: #d1fae5; border: 2px solid #198754 !important; color: #198754; }
    .medium-match { background-color: #fff3cd; border: 2px solid #ffc107 !important; color: #856404; }
    .low-match { background-color: #f8d7da; border: 2px solid #dc3545 !important; color: #721c24; }

    .points-badge {
        font-size: 0.8rem;
        padding: 4px 8px;
        border-radius: 20px;
        background: #e9ecef;
        font-weight: 600;
    }

    .empty-state-text {
        color: #adb5bd;
        font-style: italic;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-dark">‚≠ê Scholarship Match Score Generator</h1>
        <p class="text-muted mx-auto" style="max-width: 600px;">
            Evaluate your scholarship competitiveness. Enter your academic and personal details to generate a compatibility score out of 100.
        </p>
    </div>

    

    <div class="calc-wrapper mx-auto" style="max-width: 1000px;">
        
        <h5 class="fw-bold mb-4"><i class="bi bi-person-badge me-2 text-primary"></i>Application Profile</h5>

        <div class="row g-4 mb-5">
            <div class="col-md-6">
                <div class="score-section">
                    <div class="section-title text-primary">
                        <i class="bi bi-mortarboard-fill me-2"></i> Academic Performance
                    </div>
                    <label class="form-label small text-muted">Current GPA (out of 4.0)</label>
                    <input type="number" id="gpa-input" class="form-control" min="0" max="4.0" step="0.01" placeholder="Enter GPA..." oninput="calculateScore()">
                    <div class="mt-2 text-end">
                        <span class="points-badge">Weighted: <span id="gpa-points">0</span>/30</span>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="score-section">
                    <div class="section-title text-danger">
                        <i class="bi bi-cash-stack me-2"></i> Financial Need
                    </div>
                    <label class="form-label small text-muted">Self-Reported Need Level</label>
                    <select id="need-input" class="form-select" onchange="calculateScore()">
                        <option value="" selected disabled>Select need level...</option>
                        <option value="0">Minimal/No Need (0 pts)</option>
                        <option value="10">Low to Moderate (10 pts)</option>
                        <option value="15">Moderate to High (15 pts)</option>
                        <option value="20">Very High Need (20 pts)</option>
                    </select>
                    <div class="mt-2 text-end">
                        <span class="points-badge">Awarded: <span id="need-points">0</span>/20</span>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="score-section">
                    <div class="section-title text-info">
                        <i class="bi bi-journal-bookmark-fill me-2"></i> Field of Study
                    </div>
                    <label class="form-label small text-muted">Scholarship Specificity</label>
                    <select id="major-input" class="form-select" onchange="calculateScore()">
                        <option value="" selected disabled>Select match level...</option>
                        <option value="5">Broad/General (5 pts)</option>
                        <option value="10">Related Field (10 pts)</option>
                        <option value="15">Exact Field Match (15 pts)</option>
                    </select>
                    <div class="mt-2 text-end">
                        <span class="points-badge">Awarded: <span id="major-points">0</span>/15</span>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="score-section">
                    <div class="section-title text-warning">
                        <i class="bi bi-stars me-2"></i> Extracurriculars
                    </div>
                    <label class="form-label small text-muted">Level of Leadership/Service</label>
                    <select id="ecs-input" class="form-select" onchange="calculateScore()">
                        <option value="" selected disabled>Select involvement...</option>
                        <option value="5">Low Involvement (5 pts)</option>
                        <option value="10">Club Participation (10 pts)</option>
                        <option value="15">Consistent Involvement (15 pts)</option>
                        <option value="20">Major Leadership/Impact (20 pts)</option>
                    </select>
                    <div class="mt-2 text-end">
                        <span class="points-badge">Awarded: <span id="ecs-points">0</span>/20</span>
                    </div>
                </div>
            </div>

            <div class="col-12">
                <div class="score-section">
                    <div class="section-title text-success">
                        <i class="bi bi-pencil-square me-2"></i> Essay/Statement Quality
                    </div>
                    <label class="form-label small text-muted">Narrative Strength</label>
                    <select id="essay-input" class="form-select" onchange="calculateScore()">
                        <option value="" selected disabled>Self-assess your essay...</option>
                        <option value="5">Weak/Unfocused (5 pts)</option>
                        <option value="10">Meets requirements (10 pts)</option>
                        <option value="15">Strong/Compelling (15 pts)</option>
                    </select>
                    <div class="mt-2 text-end">
                        <span class="points-badge">Awarded: <span id="essay-points">0</span>/15</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4 align-items-center">
            <div class="col-lg-6">
                <div id="score-display-box">
                    <div id="result-content" style="display: none;">
                        <span class="text-uppercase fw-bold small mb-2 d-block">Match Score</span>
                        <div id="match-score">0</div>
                        <div class="fw-bold mt-2" id="score-feedback"></div>
                    </div>
                    <div id="empty-state">
                        <i class="bi bi-calculator fs-1 mb-2 d-block"></i>
                        <span class="empty-state-text">Enter your GPA to begin calculation</span>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="card border-0 bg-light p-3">
                    <h6 class="fw-bold mb-3">Scoring Methodology:</h6>
                    <ul class="list-unstyled small mb-0">
                        <li class="mb-2 d-flex justify-content-between">Academic Standing <span>30%</span></li>
                        <li class="mb-2 d-flex justify-content-between">Financial Circumstance <span>20%</span></li>
                        <li class="mb-2 d-flex justify-content-between">Leadership/ECS <span>20%</span></li>
                        <li class="mb-2 d-flex justify-content-between">Major Relevance <span>15%</span></li>
                        <li class="d-flex justify-content-between">Writing Quality <span>15%</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="text-center mt-5">
            <button class="btn btn-link text-muted text-decoration-none" onclick="location.reload()">
                <i class="bi bi-arrow-counterclockwise"></i> Reset Calculator
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const gpaInput = document.getElementById('gpa-input');
    const needInput = document.getElementById('need-input');
    const majorInput = document.getElementById('major-input');
    const ecsInput = document.getElementById('ecs-input');
    const essayInput = document.getElementById('essay-input');

    const resultContent = document.getElementById('result-content');
    const emptyState = document.getElementById('empty-state');
    const matchScoreEl = document.getElementById('match-score');
    const scoreDisplayBoxEl = document.getElementById('score-display-box');
    const scoreFeedbackEl = document.getElementById('score-feedback');

    function calculateScore() {
        // Validation: Only calculate if GPA (primary metric) is entered
        if (!gpaInput.value || gpaInput.value === "") {
            resultContent.style.display = 'none';
            emptyState.style.display = 'block';
            return;
        }

        emptyState.style.display = 'none';
        resultContent.style.display = 'block';

        let totalScore = 0;

        // GPA (Max 30)
        let gpa = Math.min(4.0, Math.max(0, parseFloat(gpaInput.value) || 0));
        let gpaPoints = (gpa / 4.0) * 30;
        document.getElementById('gpa-points').textContent = gpaPoints.toFixed(1);
        totalScore += gpaPoints;

        // Financial Need (Max 20)
        let needPoints = parseFloat(needInput.value) || 0;
        document.getElementById('need-points').textContent = needPoints;
        totalScore += needPoints;

        // Major Match (Max 15)
        let majorPoints = parseFloat(majorInput.value) || 0;
        document.getElementById('major-points').textContent = majorPoints;
        totalScore += majorPoints;

        // ECS (Max 20)
        let ecsPoints = parseFloat(ecsInput.value) || 0;
        document.getElementById('ecs-points').textContent = ecsPoints;
        totalScore += ecsPoints;

        // Essay (Max 15)
        let essayPoints = parseFloat(essayInput.value) || 0;
        document.getElementById('essay-points').textContent = essayPoints;
        totalScore += essayPoints;

        updateDisplay(totalScore);
    }

    function updateDisplay(score) {
        matchScoreEl.textContent = Math.round(score);
        scoreDisplayBoxEl.classList.remove('high-match', 'medium-match', 'low-match');
        
        let feedback = "";
        let colorClass = "";

        if (score >= 85) {
            colorClass = 'high-match';
            feedback = "Strong Candidate: High probability of matching merit criteria.";
        } else if (score >= 65) {
            colorClass = 'medium-match';
            feedback = "Competitive Candidate: Good match. Focus on your essay to stand out.";
        } else {
            colorClass = 'low-match';
            feedback = "Developing Candidate: Consider targeting niche or local scholarships.";
        }

        scoreDisplayBoxEl.classList.add(colorClass);
        scoreFeedbackEl.textContent = feedback;
    }
</script>
{% endblock %}