{% extends "base.html" %}

{% block title %}Internship Stipend Budget Calculator{% endblock %}

{% block meta_description %}Plan and track your internship finances by calculating total and weekly budgets, expenses, and net surplus/deficit.{% endblock %}

{% block meta_keywords %}internship budget, stipend calculator, weekly spending, financial planning, student finance, summer internship cost{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
    .calc-wrapper {
        background: white;
        padding: 40px;
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid #dee2e6;
    }

    .input-section-card {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 12px;
        padding: 25px;
    }

    .stat-card {
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid rgba(0,0,0,0.05);
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .stat-label {
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        color: #6c757d;
        margin-bottom: 8px;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 800;
        line-height: 1.2;
    }

    .highlight-card {
        background-color: #f0f7ff;
        border: 2px solid #0d6efd;
    }

    .income-border { border-left: 5px solid #0d6efd; }
    .expense-border { border-left: 5px solid #dc3545; }

    /* Remove arrows from number inputs */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-dark">ðŸ’µ Internship Stipend Budget Planner</h1>
        <p class="text-muted mx-auto" style="max-width: 650px;">
            Calculate your weekly spending power and total summer savings. Enter your stipend and estimated costs to visualize your financial roadmap.
        </p>
    </div>

    

    <div class="calc-wrapper mx-auto" style="max-width: 1100px;">
        <div class="row g-4">
            
            <div class="col-lg-5">
                <div class="space-y-4">
                    <div class="input-section-card income-border mb-4 shadow-sm">
                        <h6 class="fw-bold text-primary mb-3 text-uppercase"><i class="bi bi-cash-stack me-2"></i>Income & Duration</h6>
                        <div class="mb-3">
                            <label class="form-label small fw-bold">Total Stipend Amount ($)</label>
                            <div class="input-group">
                                <span class="input-group-text bg-white">$</span>
                                <input type="number" id="total-stipend" class="form-control form-control-lg" placeholder="e.g. 5000" oninput="calculate()">
                            </div>
                        </div>
                        <div class="mb-0">
                            <label class="form-label small fw-bold">Duration (Weeks)</label>
                            <input type="number" id="internship-weeks" class="form-control form-control-lg" placeholder="e.g. 10" oninput="calculate()">
                        </div>
                    </div>

                    <div class="input-section-card expense-border shadow-sm">
                        <h6 class="fw-bold text-danger mb-3 text-uppercase"><i class="bi bi-cart-x me-2"></i>Estimated Total Expenses</h6>
                        <div class="row g-2">
                            <div class="col-6 mb-2">
                                <label class="form-label small fw-bold">Housing/Rent</label>
                                <input type="number" id="housing-cost" class="form-control" placeholder="0" oninput="calculate()">
                            </div>
                            <div class="col-6 mb-2">
                                <label class="form-label small fw-bold">Food/Groceries</label>
                                <input type="number" id="food-cost" class="form-control" placeholder="0" oninput="calculate()">
                            </div>
                            <div class="col-6">
                                <label class="form-label small fw-bold">Transport</label>
                                <input type="number" id="transport-cost" class="form-control" placeholder="0" oninput="calculate()">
                            </div>
                            <div class="col-6">
                                <label class="form-label small fw-bold">Other Essentials</label>
                                <input type="number" id="other-cost" class="form-control" placeholder="0" oninput="calculate()">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-7">
                <div id="results-area" class="h-100">
                    
                    <div id="empty-state" class="h-100 d-flex flex-column justify-content-center align-items-center text-center p-5 border rounded bg-light">
                        <i class="bi bi-wallet2 fs-1 text-muted mb-3"></i>
                        <h4 class="fw-bold text-muted">Ready to Plan?</h4>
                        <p class="text-muted">Enter your stipend and expected duration to unlock your financial summary.</p>
                    </div>

                    <div id="calc-content" style="display: none;">
                        <h6 class="fw-bold text-secondary mb-3 text-uppercase">Financial Analysis</h6>
                        
                        <div class="stat-card highlight-card mb-4 shadow-sm">
                            <div class="stat-label">Total Net Outcome</div>
                            <div class="stat-value" id="net-outcome-total">--</div>
                            <div class="fw-bold mt-2 text-uppercase small" id="net-outcome-status"></div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="stat-box p-3 border rounded bg-white shadow-sm">
                                    <div class="stat-label">Total Expenses</div>
                                    <div class="h3 fw-bold text-danger mb-0" id="total-expenses">$0</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="stat-box p-3 border rounded bg-white shadow-sm">
                                    <div class="stat-label">Avg. Weekly Income</div>
                                    <div class="h3 fw-bold text-primary mb-0" id="weekly-budget">$0</div>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border rounded shadow-sm bg-white border-top border-4 border-success">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <div class="stat-label m-0">Weekly Discretionary Spending</div>
                                <i class="bi bi-info-circle text-muted" data-bs-toggle="tooltip" title="Money remaining each week after covering fixed costs like housing and transport."></i>
                            </div>
                            <div class="h1 fw-black text-success mb-1" id="max-weekly-spending">$0.00</div>
                            <p class="text-muted small mb-0">Your "Daily Allowance" for food, fun, and incidentals.</p>
                        </div>

                    </div>

                </div>
            </div>
        </div>

        <div class="mt-5 p-3 bg-light rounded-3 small text-muted">
            <i class="bi bi-shield-check me-2 text-primary"></i>
            <strong>Professional Advice:</strong> Always aim for a 10% "Emergency Buffer" in your internship budget to cover unexpected travel or social opportunities.
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function calculate() {
        const stipend = parseFloat(document.getElementById('total-stipend').value);
        const weeks = parseFloat(document.getElementById('internship-weeks').value);
        
        const housing = parseFloat(document.getElementById('housing-cost').value) || 0;
        const food = parseFloat(document.getElementById('food-cost').value) || 0;
        const transport = parseFloat(document.getElementById('transport-cost').value) || 0;
        const other = parseFloat(document.getElementById('other-cost').value) || 0;

        const emptyState = document.getElementById('empty-state');
        const calcContent = document.getElementById('calc-content');

        // Initial Visibility Logic
        if (!stipend || !weeks || weeks <= 0) {
            emptyState.style.display = 'flex';
            calcContent.style.display = 'none';
            return;
        }

        emptyState.style.display = 'none';
        calcContent.style.display = 'block';

        // Calculations
        const totalExpenses = housing + food + transport + other;
        const netTotal = stipend - totalExpenses;
        const weeklyIncome = stipend / weeks;
        
        // Discretionary calculation (Weekly stipend minus fixed weekly costs)
        const fixedWeekly = (housing + transport + other) / weeks;
        const discretionary = weeklyIncome - fixedWeekly;

        // UI Updates
        document.getElementById('total-expenses').textContent = `$${totalExpenses.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        document.getElementById('weekly-budget').textContent = `$${weeklyIncome.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        
        const outcomeEl = document.getElementById('net-outcome-total');
        const statusEl = document.getElementById('net-outcome-status');
        
        outcomeEl.textContent = `$${Math.abs(netTotal).toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        
        if (netTotal >= 0) {
            outcomeEl.className = 'stat-value text-success';
            statusEl.textContent = 'Projected Surplus';
            statusEl.className = 'fw-bold mt-2 text-uppercase small text-success';
        } else {
            outcomeEl.className = 'stat-value text-danger';
            statusEl.textContent = 'Projected Deficit';
            statusEl.className = 'fw-bold mt-2 text-uppercase small text-danger';
        }

        const spendEl = document.getElementById('max-weekly-spending');
        spendEl.textContent = `$${Math.max(0, discretionary).toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        spendEl.className = discretionary > 0 ? 'h1 fw-black text-success mb-1' : 'h1 fw-black text-danger mb-1';
    }
</script>
{% endblock %}