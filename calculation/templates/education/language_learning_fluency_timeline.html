{% extends "base.html" %}

{% block title %}Language Learning Fluency Timeline{% endblock %}

{% block meta_description %}Estimate the hours and timeline required to reach CEFR fluency levels (A1 to C2) based on language difficulty and weekly study commitment.{% endblock %}

{% block meta_keywords %}language learning, CEFR levels, fluency timeline, study hours, FSI difficulty, language planner{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
    :root {
        --bs-primary-rgb: 20, 184, 166; /* Teal 500 */
    }

    body {
        background-color: #f8fafc;
    }

    .calc-card {
        background: white;
        border-radius: 1.25rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        border: 1px solid #e2e8f0;
        overflow: hidden;
    }

    .input-sidebar {
        background-color: #f0fdfa;
        border-right: 1px solid #ccfbf1;
    }

    .form-label {
        font-weight: 700;
        color: #334155;
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.025em;
    }

    .result-display-box {
        background-color: #f0fdfa;
        border: 2px solid #5eead4;
        border-radius: 1rem;
        padding: 2rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .result-value {
        font-size: 3.5rem;
        font-weight: 800;
        line-height: 1;
        color: #0d9488;
    }

    .placeholder-state {
        padding: 5rem 2rem;
        text-align: center;
        color: #94a3b8;
    }

    .table thead th {
        background-color: #f8fafc;
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.05em;
        color: #64748b;
        border-top: none;
    }

    .cefr-badge {
        font-weight: 800;
        color: #0f766e;
    }

    .fsi-info-card {
        font-size: 0.8rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-dark"><i class="bi bi-translate text-teal me-2" style="color: #14b8a6;"></i>Fluency Timeline Planner</h1>
        <p class="text-muted mx-auto" style="max-width: 650px;">
            Estimate how long it will take to reach your target proficiency level using the U.S. Foreign Service Institute (FSI) difficulty categories.
        </p>
    </div>

    

    <div class="calc-card mx-auto" style="max-width: 1050px;">
        <div class="row g-0">
            <div class="col-lg-5 input-sidebar p-4 p-md-5">
                <h5 class="fw-bold mb-4 text-dark"><i class="bi bi-sliders2-vertical me-2"></i>Study Parameters</h5>
                
                <div class="mb-4">
                    <label class="form-label">Language Difficulty</label>
                    <select id="language-difficulty" class="form-select border-0 shadow-sm py-2">
                        <option value="" selected disabled>Choose Difficulty...</option>
                        <option value="600">Category I: Romance/Germanic (600h)</option>
                        <option value="750">Category II: German (750h)</option>
                        <option value="900">Category III: Slavic/African (900h)</option>
                        <option value="1100">Category IV: Uralic/Estonian (1100h)</option>
                        <option value="2200">Category V: Arabic/East Asian (2200h)</option>
                    </select>
                </div>

                <div class="mb-4">
                    <label class="form-label">Weekly Commitment (Hours)</label>
                    <div class="input-group shadow-sm">
                        <span class="input-group-text bg-white border-0"><i class="bi bi-clock"></i></span>
                        <input type="number" id="weekly-hours" class="form-control border-0 py-2" placeholder="e.g. 10">
                    </div>
                    <div class="mt-2 d-flex justify-content-between px-1">
                        <span class="badge bg-light text-dark border fw-normal">Casual: 5h</span>
                        <span class="badge bg-light text-dark border fw-normal">Serious: 15h</span>
                        <span class="badge bg-light text-dark border fw-normal">Immersion: 30h+</span>
                    </div>
                </div>

                <div class="fsi-info-card p-3 mt-5">
                    <h6 class="fw-bold small mb-2 text-uppercase"><i class="bi bi-info-circle me-1"></i>Category Examples</h6>
                    <ul class="list-unstyled mb-0 text-muted">
                        <li><strong>Cat I:</strong> Spanish, French, Italian, Dutch</li>
                        <li><strong>Cat III:</strong> Russian, Greek, Vietnamese</li>
                        <li><strong>Cat V:</strong> Arabic, Chinese, Japanese, Korean</li>
                    </ul>
                </div>
            </div>

            <div class="col-lg-7 p-4 p-md-5 bg-white d-flex align-items-center">
                
                <div id="placeholder-ui" class="placeholder-state w-100">
                    <i class="bi bi-journal-check display-1 mb-3 opacity-25"></i>
                    <h4 class="fw-bold text-dark">Ready to Calculate</h4>
                    <p>Select a language category and study commitment to generate your personalized fluency roadmap.</p>
                </div>

                <div id="results-ui" class="w-100 d-none">
                    <div class="result-display-box mb-4">
                        <span class="form-label text-teal opacity-75">Timeline to Working Fluency (C1)</span>
                        <div class="result-value" id="total-weeks">0</div>
                        <p class="mb-0 mt-2 text-dark fw-bold">Estimated <span id="total-years">0</span> Years</p>
                    </div>

                    <h6 class="fw-bold text-dark mb-3"><i class="bi bi-graph-up-arrow me-2"></i>Roadmap to Mastery</h6>
                    <div class="table-responsive">
                        <table class="table align-middle">
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th class="text-center">Total Hrs</th>
                                    <th class="text-end">Weeks</th>
                                    <th class="text-end">Months</th>
                                </tr>
                            </thead>
                            <tbody id="timeline-body">
                                </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    const difficultySelect = document.getElementById('language-difficulty');
    const weeklyInput = document.getElementById('weekly-hours');
    
    const cefrDistribution = [
        { level: 'A1 Beginner', percentage: 0.10 },
        { level: 'A2 Elementary', percentage: 0.20 },
        { level: 'B1 Intermediate', percentage: 0.40 },
        { level: 'B2 Upper-Int', percentage: 0.65 },
        { level: 'C1 Fluency', percentage: 1.00 },
        { level: 'C2 Mastery', percentage: 1.35 }
    ];

    function calculate() {
        const targetHours = parseFloat(difficultySelect.value);
        const weeklyHours = parseFloat(weeklyInput.value);
        
        const placeholder = document.getElementById('placeholder-ui');
        const results = document.getElementById('results-ui');

        if (!targetHours || !weeklyHours || weeklyHours <= 0) {
            placeholder.classList.remove('d-none');
            results.classList.add('d-none');
            return;
        }

        placeholder.classList.add('d-none');
        results.classList.remove('d-none');

        const weeksToC1 = targetHours / weeklyHours;
        document.getElementById('total-weeks').textContent = Math.ceil(weeksToC1);
        document.getElementById('total-years').textContent = (weeksToC1 / 52.14).toFixed(1);

        const tbody = document.getElementById('timeline-body');
        tbody.innerHTML = '';

        cefrDistribution.forEach(data => {
            const hours = targetHours * data.percentage;
            const weeks = hours / weeklyHours;
            const months = weeks / 4.345;

            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="cefr-badge small">${data.level}</td>
                <td class="text-center small">${Math.round(hours)}</td>
                <td class="text-end small">${Math.ceil(weeks)}</td>
                <td class="text-end fw-bold text-teal">${months.toFixed(1)}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    [difficultySelect, weeklyInput].forEach(el => {
        el.addEventListener('input', calculate);
    });
</script>
{% endblock %}