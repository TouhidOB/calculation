{% extends "base.html" %}

{% block title %}Digital Image Resolution Converter (DPI to Pixels){% endblock %}

{% block meta_description %}Calculate the required pixel dimensions for print based on physical size (Inches/cm) and resolution (DPI/DPcm).{% endblock %}

{% block meta_keywords %}dpi to pixels, resolution converter, print resolution, digital imaging, dots per inch, dpcm{% endblock %}

{% block extra_head %}
<style>
    /* Base styles from the template */
    .calc-wrapper {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    }
    
    .section-title {
        font-weight: 600;
        margin-top: 20px;
        color: #343a40;
    }
    
    /* Input Group Styling */
    .conversion-input-group {
        display: flex;
        flex-direction: column;
        margin-bottom: 20px;
        background: #f0f8ff; /* Light blue/sky theme for digital/screens */
        border-radius: 8px;
        padding: 15px;
        border: 1px solid #17a2b8;
    }
    
    .conversion-input-group label {
        font-weight: 500;
        margin-bottom: 5px;
        color: #007bff;
    }

    .conversion-input-group input[type="number"],
    .conversion-input-group select {
        font-size: 1.1rem;
        padding: 8px;
        border-radius: 6px;
        border: 1px solid #ced4da;
    }
    
    .input-row {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 10px;
        align-items: center;
    }

    /* Results List Styling */
    .result-list-group {
        border-radius: 8px;
        overflow: hidden;
    }

    .result-list-group .list-group-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px;
        border-left: 4px solid transparent;
        transition: all 0.2s ease;
    }
    
    .result-list-group .list-group-item:hover {
        background-color: #f1f3f5;
    }

    .result-list-group .unit-name {
        font-weight: 500;
        color: #495057;
    }
    
    .result-list-group .unit-value {
        font-size: 1.2rem;
        font-weight: bold;
        color: #17a2b8; /* Cyan/Teal theme */
    }
    
    .highlight-item {
        border-left-color: #17a2b8 !important; 
        background-color: #f3fcff;
    }
    
    .conversion-button {
        background-color: #17a2b8;
        color: white;
        font-weight: bold;
        padding: 12px;
        margin-top: 20px;
        border-radius: 8px;
        width: 100%;
        transition: background-color 0.2s;
    }
    .conversion-button:hover {
        background-color: #117a8b;
    }

    .pixel-count {
        font-size: 1.5rem;
        color: #007bff;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-4">
    <h1 class="mb-3">üñºÔ∏è Image Resolution Converter</h1>
    <p class="small-muted">Calculate the **pixel dimensions** needed for an image to print correctly at a specific physical size and resolution. </p>
    

    <div class="calc-wrapper mt-4">

        <h5 class="section-title">Step 1: Physical Size Input</h5>

        <div class="conversion-input-group">
            <label>Print Dimensions (Width $\times$ Height)</label>
            <div class="input-row mb-3">
                <input type="number" class="form-control" id="widthInput" placeholder="Width" value="8" min="0.1" step="any" autofocus>
                <select id="sizeUnitSelect" class="form-select">
                    <option value="in">Inches (in)</option>
                    <option value="cm">Centimeters (cm)</option>
                </select>
            </div>
            <div class="input-row">
                <input type="number" class="form-control" id="heightInput" placeholder="Height" value="10" min="0.1" step="any">
                <span class="text-muted small align-self-center">(Size Unit applies to both)</span>
            </div>
        </div>

        <h5 class="section-title">Step 2: Resolution Input</h5>

        <div class="conversion-input-group">
            <label>Print Resolution</label>
            <div class="input-row">
                <input type="number" class="form-control" id="resolutionInput" placeholder="Resolution" value="300" min="1" step="any">
                <select id="resolutionUnitSelect" class="form-select">
                    <option value="dpi">DPI (Dots Per Inch)</option>
                    <option value="dpcm">DPcm (Dots Per Centimeter)</option>
                </select>
            </div>
        </div>

        <button class="btn conversion-button" id="convertButton">
            Calculate Pixels
        </button>

        <h5 class="section-title mt-4">Step 3: Required Pixel Dimensions</h5>
        
        <div class="list-group result-list-group mt-3" id="resultsList">
            <!-- Results will be dynamically inserted here -->
        </div>

    </div>
    
    <div class="mt-5">
        <p class="small-muted">**Calculation Basis:** The required pixel size is calculated as: $Pixels = Physical \text{ Size} \times Resolution$. A standard print resolution is $300 \text{ DPI}$.</p>
    </div>

</div>
{% endblock %}

{% block extra_js %}
<script>
    // --- CONVERSION CONSTANTS ---
    // Base distance unit: Inches (in)
    // Base resolution unit: DPI (Dots Per Inch)
    const CONSTANTS = {
        CM_TO_INCH: 1 / 2.54, // 1 cm is this many inches
        DPI_TO_DPCM: 1 / 2.54 // 1 DPcm is 2.54 times DPI
    };

    const widthInput = document.getElementById('widthInput');
    const heightInput = document.getElementById('heightInput');
    const sizeUnitSelect = document.getElementById('sizeUnitSelect');
    const resolutionInput = document.getElementById('resolutionInput');
    const resolutionUnitSelect = document.getElementById('resolutionUnitSelect');
    const convertButton = document.getElementById('convertButton');
    const resultsList = document.getElementById('resultsList');
    
    /**
     * Converts a measurement value to the base unit (Inches).
     * @param {number} value - The dimension value.
     * @param {string} unit - 'in' or 'cm'.
     * @returns {number} Value in Inches.
     */
    function convertToInches(value, unit) {
        if (unit === 'cm') {
            return value * CONSTANTS.CM_TO_INCH;
        }
        return value; // Already in inches
    }

    /**
     * Converts a resolution value to the base unit (DPI).
     * @param {number} value - The resolution value.
     * @param {string} unit - 'dpi' or 'dpcm'.
     * @returns {number} Value in DPI.
     */
    function convertToDPI(value, unit) {
        if (unit === 'dpcm') {
            // 1 DPcm = 2.54 DPI
            return value / CONSTANTS.DPI_TO_DPCM; 
        }
        return value; // Already in DPI
    }

    /**
     * Main function to calculate pixel dimensions.
     */
    function calculateResolution() {
        const inputWidth = parseFloat(widthInput.value);
        const inputHeight = parseFloat(heightInput.value);
        const inputResolution = parseFloat(resolutionInput.value);
        
        const sizeUnit = sizeUnitSelect.value;
        const resolutionUnit = resolutionUnitSelect.value;
        
        resultsList.innerHTML = '';

        if (isNaN(inputWidth) || isNaN(inputHeight) || isNaN(inputResolution) || inputWidth <= 0 || inputHeight <= 0 || inputResolution <= 0) {
            resultsList.innerHTML = `<div class="alert alert-warning">Please enter valid, positive numbers for all dimensions and resolution.</div>`;
            return;
        }

        // 1. Normalize all inputs to base units (Inches and DPI)
        const widthInInches = convertToInches(inputWidth, sizeUnit);
        const heightInInches = convertToInches(inputHeight, sizeUnit);
        const resolutionInDPI = convertToDPI(inputResolution, resolutionUnit);

        // 2. Calculate Pixels: Pixels = Inches * DPI
        // Math.ceil is used as pixel counts must be whole numbers, and rounding up is safer for print.
        const pixelsWidth = Math.ceil(widthInInches * resolutionInDPI);
        const pixelsHeight = Math.ceil(heightInInches * resolutionInDPI);
        
        const totalPixels = pixelsWidth * pixelsHeight;

        // 3. Display Results
        
        // --- Pixel Dimensions Result ---
        resultsList.innerHTML += `
            <div class="list-group-item highlight-item flex-column align-items-start">
                <span class="unit-name mb-1">Required Pixel Dimensions:</span>
                <span class="pixel-count">${pixelsWidth} $\times$ ${pixelsHeight} Pixels</span>
            </div>
        `;

        // --- Total Pixel Count Result ---
        resultsList.innerHTML += `
            <div class="list-group-item">
                <span class="unit-name">Total Pixel Count (Megapixels)</span>
                <span class="unit-value">${(totalPixels / 1000000).toFixed(2)} MP</span>
            </div>
        `;

        // --- Calculated DPI/DPcm ---
        const dpcmResult = (resolutionInDPI * CONSTANTS.DPI_TO_DPCM).toFixed(2);
        const dpiResult = resolutionInDPI.toFixed(2);

        resultsList.innerHTML += `
            <div class="list-group-item">
                <span class="unit-name">Effective Resolution (DPI)</span>
                <span class="unit-value">${dpiResult} DPI</span>
            </div>
            <div class="list-group-item">
                <span class="unit-name">Effective Resolution (DPcm)</span>
                <span class="unit-value">${dpcmResult} DPcm</span>
            </div>
        `;
    }

    // --- Event Listeners and Initialization ---
    
    // Function to attach listeners to all input elements for real-time updates
    function setupListeners() {
        const inputs = [widthInput, heightInput, resolutionInput, sizeUnitSelect, resolutionUnitSelect];
        inputs.forEach(input => {
            input.addEventListener('input', calculateResolution);
            input.addEventListener('change', calculateResolution);
        });
        convertButton.addEventListener('click', calculateResolution);
    }

    window.onload = function() {
        setupListeners();
        calculateResolution(); // Initial calculation on load
    };

</script>
{% endblock %}